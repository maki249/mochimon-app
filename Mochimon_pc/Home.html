<!DOCTYPE html>
<html lang="ja">
<head>
    <script type="text/javascript">
        /*
        if (navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i)) {

            window.location.href = "../Mochimon_mobile/Home.html";
        }
        */
    </script>
    

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ホーム</title>
    <link rel="stylesheet" href="Home.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="container">
        <header class="header-area">
            <h1>Mochimon</h1>

            <a id="user-icon-btn" href="#" class="login-button">
                <span>
                    <i class="fa-regular fa-user"></i>
                </span>
            </a>
        </header>

        <nav class="left-menu">
            <ul>
                <li><a href="#" class="select">ホーム</a></li>
                <li><a href="Calendar.html">カレンダー</a></li>
                <li><a href="Template.html">テンプレート</a></li>
                <li><a href="Shopping.html">買い物リスト</a></li>
                <li><a href="Share.html">共有</a></li>
            </ul>
        </nav>

        <main class="content">
            <h2>コンテンツ表示</h2>
            <p>ここに選択したメニューのコンテンツが表示されます。</p>
        </main>

        <aside class="right-sidebar">
            <h2>編集</h2>
            <p>編集用のツールや情報をここに配置します。</p>
        </aside>
    </div>
            <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-analytics.js";
            import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";

            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries

            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
                apiKey: "AIzaSyChPt5NDvgd4okxbUQalZtrS7w6Tm30fgg",
                authDomain: "mochimon-base.firebaseapp.com",
                projectId: "mochimon-base",
                storageBucket: "mochimon-base.firebasestorage.app",
                messagingSenderId: "5202457046",
                appId: "1:5202457046:web:7233c6b556a7d260803477",
                measurementId: "G-GPT541EW6S"
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const auth = getAuth(app);
            const iconBtn = document.getElementById("login-button");
            let currentUser = null;

            // ユーザーの認証状態が変わるたびにcurrentUserにセット
            onAuthStateChanged(auth, (user) => {
            currentUser = user;
            console.log("Auth state changed:", user);
            });
            
            
                if (iconBtn) {
                    iconBtn.addEventListener("click", async (e) => {
                        e.preventDefault();
                        console.log("Clicked. currentUser:", currentUser);
                        if (currentUser) {
                        console.log("認証済みなのでマイページへ遷移");
                        window.location.href = "../Mypage.html";
                        } else {
                        console.log("未認証なのでログインへ遷移");
                        window.location.href = "../Login.html";
                        }
                    });
                }

        </script>
        
        <script type="module" src="../login.js">
        </script>
</body>
</html>